<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Débitage Facile</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        label, input {
            margin: 10px 0;
        }
        #resultat {
            margin-top: 20px;
        }
        .barre {
            margin-bottom: 10px;
        }
        .chute {
            font-style: italic;
            color: red;
        }
    </style>
</head>
<body>

    <h1>Optimisation de Mise en Barre</h1>

    <!-- Formulaire -->
    <form id="form">
        <label for="longueurBarre">Longueur de barre standard (mm):</label><br>
        <input type="number" id="longueurBarre" required><br>

        <label for="pieces">Liste des longueurs à découper (ex : 1200, 1800, etc. avec quantités, séparées par des virgules):</label><br>
        <input type="text" id="pieces" placeholder="Ex : 1200, 1800, 2900" required><br>

        <button type="submit">Optimiser</button>
    </form>

    <!-- Résultats -->
    <div id="resultat"></div>

    <script>
        // Fonction pour appliquer l'algorithme First Fit
        function optimiserDecoupe(longueurBarre, pieces) {
            let barres = [];
            let chute;

            // On commence par trier les pièces par longueur décroissante (pour une meilleure efficacité de First Fit)
            pieces.sort((a, b) => b - a);

            pieces.forEach(piece => {
                let ajouté = false;
                for (let i = 0; i < barres.length; i++) {
                    if (barres[i] + piece <= longueurBarre) {
                        barres[i] += piece;
                        ajouté = true;
                        break;
                    }
                }
                if (!ajouté) {
                    barres.push(piece);
                }
            });

            // Calcul des chutes
            chute = barres.map(barre => longueurBarre - barre);

            return { barres, chute };
        }

        // Gérer la soumission du formulaire
        document.getElementById("form").addEventListener("submit", function(e) {
            e.preventDefault();

            const longueurBarre = parseInt(document.getElementById("longueurBarre").value);
            const pieces = document.getElementById("pieces").value.split(',').map(piece => parseInt(piece.trim()));

            // Appel de la fonction pour optimiser les barres
            const resultat = optimiserDecoupe(longueurBarre, pieces);

            // Afficher le résultat
            let html = `<h2>Plan de découpe :</h2>`;
            resultat.barres.forEach((barre, index) => {
                html += `<div class="barre">Barre ${index + 1}: ${barre} mm (Chute: ${resultat.chute[index]} mm)</div>`;
            });
            if (resultat.chute.some(chute => chute > 0)) {
                html += `<div class="chute">Chutes totales: ${resultat.chute.reduce((acc, chute) => acc + chute, 0)} mm</div>`;
            } else {
                html += `<div class="chute">Aucune chute.</div>`;
            }

            document.getElementById("resultat").innerHTML = html;
        });
    </script>

</body>
</html>
